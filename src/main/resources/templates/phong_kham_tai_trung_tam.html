<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" class="light" lang="vi"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Quản lý Phòng khám Trung tâm</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#13ec5b",
                        "background-light": "#f6f8f6",
                        "background-dark": "#102216",
                    },
                    fontFamily: {
                        "display": ["Manrope"]
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Manrope', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .tab-active {
            @apply text-primary border-b-2 border-primary;
        }
        .tab-inactive {
            @apply text-[#61896f] border-b-2 border-transparent hover:text-[#111813] dark:hover:text-white transition-all;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark min-h-screen">
<div class="flex h-screen overflow-hidden">
<!-- Main Content Area -->
<main class="flex-1 overflow-y-auto flex flex-col">
<!-- Breadcrumbs & Header -->
<header class="bg-white dark:bg-zinc-900 border-b border-zinc-200 dark:border-zinc-800 px-8 py-4">
<div class="flex items-center justify-between mb-4">
<div class="flex items-center gap-3">
<button onclick="window.location.href='/admin/centers'" class="p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg transition-colors text-[#61896f] dark:text-zinc-400" title="Quay lại Quản lý Trung tâm">
<span class="material-symbols-outlined">arrow_back</span>
</button>
<div class="flex items-center gap-2">
<a class="text-[#61896f] dark:text-zinc-400 text-sm font-medium hover:underline" th:href="@{/admin/home}">Hệ thống</a>
<span class="text-[#61896f] dark:text-zinc-400 text-sm font-medium">/</span>
<a class="text-[#61896f] dark:text-zinc-400 text-sm font-medium hover:underline" th:href="@{/admin/centers}">Trung tâm</a>
<span class="text-[#61896f] dark:text-zinc-400 text-sm font-medium">/</span>
<span class="text-[#111813] dark:text-white text-sm font-bold">Quản lý Phòng khám</span>
</div>
</div>
<div class="flex items-center gap-4">
<button class="p-2 text-zinc-500 hover:bg-zinc-100 rounded-full">
<span class="material-symbols-outlined">notifications</span>
</button>
<div class="w-8 h-8 rounded-full bg-zinc-200" data-alt="User profile avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCK1FqPRnOWmvNIrlovizkWRGlIfpqgn4634K5Ed7_Epi3Ta3-uNu-9RckQp7SIEW1j2yA2aKj9DdT3AvWT5C-1N3haU_V1Pp3icSh8TSGTGAkzhpdyLJLaZSwwJaTtcjnEpokD5uGensaIJ96i9dDSTF3f1iUy-4dLhcqzOv_wXfw_6OZt2hVTIRPkhKXybSGyWB7zAe3NvVHWXRJO9tW8QSmsC3tH94AMmnu3N3Sv_8s3A6Wmun_5PdqdLu7wT_JwVP1vJLpCPV1s"); background-size: cover;'></div>
</div>
</div>
<div class="flex flex-wrap items-center justify-between gap-4">
<div>
<h2 class="text-[#111813] dark:text-white text-3xl font-extrabold tracking-tight" id="centerTitle">Danh sách Phòng khám</h2>
<p class="text-[#61896f] dark:text-zinc-400 text-sm mt-1" id="centerAddress">Quản lý thông tin, chức năng và trạng thái các phòng khám tại trung tâm.</p>
</div>
</div>
</header>
<!-- Content Body -->
<div class="p-8 flex-1 flex flex-col gap-6">
<!-- Tabs -->
<div class="flex gap-8 border-b border-zinc-200 dark:border-zinc-800">
<button onclick="switchTab('vaccines')" class="tab-inactive py-4 text-sm font-semibold flex items-center gap-2" id="vaccinesTab">
<span class="material-symbols-outlined text-lg leading-none">vaccines</span>
                            Vaccine tại Trung tâm
                        </button>
<button id="roomsTab" class="tab-active py-4 text-sm font-bold flex items-center gap-2">
<span class="material-symbols-outlined text-lg leading-none">meeting_room</span>
                            Phòng khám
                        </button>
<button onclick="switchTab('working-hours')" class="tab-inactive py-4 text-sm font-semibold flex items-center gap-2" id="workingHoursTab">
<span class="material-symbols-outlined text-lg leading-none">schedule</span>
                            Giờ làm việc
                        </button>
</div>
<div class="flex items-center justify-between">
<div class="flex-1">
<label class="flex items-center w-full h-12 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 focus-within:ring-2 ring-primary/30 transition-all">
<span class="material-symbols-outlined text-[#61896f]">search</span>
<input id="roomSearch" class="flex-1 border-none bg-transparent focus:ring-0 text-[#111813] dark:text-white placeholder:text-[#61896f] px-3 text-sm" placeholder="Tìm kiếm theo số phòng hoặc chức năng..."/>
</label>
</div>
<div class="flex gap-2 ml-4">
<select id="statusFilter" class="h-12 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 text-sm font-medium text-[#111813] dark:text-white focus:ring-primary/30 border-none">
<option value="">Tất cả trạng thái</option>
<option value="true">Hoạt động</option>
<option value="false">Tạm ngưng</option>
</select>
<button onclick="openAddRoomModal()" class="flex items-center gap-2 rounded-lg h-12 px-5 bg-[#111813] dark:bg-primary text-white dark:text-[#111813] text-sm font-bold shadow-sm hover:opacity-90 transition-all">
<span class="material-symbols-outlined">add</span>
<span>Thêm phòng mới</span>
</button>
</div>
</div>
<!-- Filters & Search Bar -->
<div class="flex flex-col md:flex-row gap-4">
<div class="flex-1">
<label class="flex items-center w-full h-12 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 focus-within:ring-2 ring-primary/30 transition-all">
<span class="material-symbols-outlined text-[#61896f]">search</span>
<input class="flex-1 border-none bg-transparent focus:ring-0 text-[#111813] dark:text-white placeholder:text-[#61896f] px-3 text-sm" placeholder="Tìm kiếm theo số phòng hoặc chức năng..."/>
</label>
</div>
<div class="flex gap-2">
<select class="h-12 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 text-sm font-medium text-[#111813] dark:text-white focus:ring-primary/30 border-none">
<option>Tất cả trạng thái</option>
<option>Hoạt động</option>
<option>Tạm ngưng</option>
</select>
<button class="flex items-center justify-center h-12 px-4 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl text-zinc-600 hover:bg-zinc-50 transition-colors">
<span class="material-symbols-outlined">filter_list</span>
</button>
</div>
</div>
<!-- Clinic Table -->
<div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
<table class="w-full text-left border-collapse">
<thead>
<tr class="bg-zinc-50 dark:bg-zinc-800/50 border-b border-zinc-200 dark:border-zinc-800">
<th class="px-6 py-4 text-xs font-bold text-zinc-500 uppercase tracking-wider">Số phòng</th>
<th class="px-6 py-4 text-xs font-bold text-zinc-500 uppercase tracking-wider">Chức năng</th>
<th class="px-6 py-4 text-xs font-bold text-zinc-500 uppercase tracking-wider">Trạng thái</th>
<th class="px-6 py-4 text-xs font-bold text-zinc-500 uppercase tracking-wider">Bác sĩ phụ trách</th>
<th class="px-6 py-4 text-xs font-bold text-zinc-500 uppercase tracking-wider text-right">Thao tác</th>
</tr>
</thead>
<tbody id="roomsTableBody" class="divide-y divide-zinc-200 dark:divide-zinc-800">
<!-- Dữ liệu sẽ được load từ API -->
<tr>
<td colspan="5" class="px-6 py-8 text-center text-[#61896f]">
<span class="material-symbols-outlined animate-spin text-2xl mb-2 inline-block">refresh</span>
<p>Đang tải dữ liệu...</p>
</td>
</tr>
</tbody>
</table>
<!-- Pagination Footer -->
<div class="bg-zinc-50 dark:bg-zinc-800/30 px-6 py-4 flex items-center justify-between border-t border-zinc-200 dark:border-zinc-800">
<p class="text-sm text-zinc-500">Hiển thị <span class="font-bold text-zinc-700 dark:text-zinc-300">1-4</span> trên <span class="font-bold text-zinc-700 dark:text-zinc-300">12</span> phòng</p>
<div class="flex gap-2">
<button class="flex items-center justify-center size-8 rounded border border-zinc-300 dark:border-zinc-700 text-zinc-400 hover:bg-white transition-colors">
<span class="material-symbols-outlined text-sm font-bold">chevron_left</span>
</button>
<button class="flex items-center justify-center size-8 rounded border-none bg-primary text-black font-bold text-sm">1</button>
<button class="flex items-center justify-center size-8 rounded border border-zinc-300 dark:border-zinc-700 text-zinc-600 hover:bg-white transition-colors text-sm">2</button>
<button class="flex items-center justify-center size-8 rounded border border-zinc-300 dark:border-zinc-700 text-zinc-600 hover:bg-white transition-colors text-sm">3</button>
<button class="flex items-center justify-center size-8 rounded border border-zinc-300 dark:border-zinc-700 text-zinc-400 hover:bg-white transition-colors">
<span class="material-symbols-outlined text-sm font-bold">chevron_right</span>
</button>
</div>
</div>
</div>
<!-- Stats Summary Section -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
<div class="bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200 dark:border-zinc-800 flex items-center gap-4">
<div class="size-12 bg-primary/20 rounded-xl flex items-center justify-center text-primary">
<span class="material-symbols-outlined">meeting_room</span>
</div>
<div>
<p class="text-zinc-500 text-xs font-bold uppercase tracking-wider">Tổng số phòng</p>
<p class="text-2xl font-black text-[#111813] dark:text-white leading-none mt-1">12</p>
</div>
</div>
<div class="bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200 dark:border-zinc-800 flex items-center gap-4">
<div class="size-12 bg-green-100 rounded-xl flex items-center justify-center text-green-600">
<span class="material-symbols-outlined">check_circle</span>
</div>
<div>
<p class="text-zinc-500 text-xs font-bold uppercase tracking-wider">Đang hoạt động</p>
<p class="text-2xl font-black text-[#111813] dark:text-white leading-none mt-1">10</p>
</div>
</div>
<div class="bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200 dark:border-zinc-800 flex items-center gap-4">
<div class="size-12 bg-zinc-100 rounded-xl flex items-center justify-center text-zinc-500">
<span class="material-symbols-outlined">pause_circle</span>
</div>
<div>
<p class="text-zinc-500 text-xs font-bold uppercase tracking-wider">Tạm ngưng</p>
<p class="text-2xl font-black text-[#111813] dark:text-white leading-none mt-1">02</p>
</div>
</div>
</div>
</div>
</main>
</div>

<script>
// Lấy centerId từ URL
const urlParams = new URLSearchParams(window.location.search);
const centerIdFromPath = window.location.pathname.match(/\/centers\/(\d+)/);
const centerId = centerIdFromPath ? centerIdFromPath[1] : null;

let clinicRooms = [];
let filteredRooms = [];
let centerData = null;

// Load thông tin trung tâm
async function loadCenterData() {
    if (!centerId) {
        console.error('Center ID not found');
        return;
    }
    
    try {
        const response = await fetch(`/api/centers/${centerId}`);
        if (response.ok) {
            centerData = await response.json();
            updateCenterHeader();
            loadClinicRooms();
        } else {
            console.error('Failed to load center data');
        }
    } catch (error) {
        console.error('Error loading center data:', error);
    }
}

function updateCenterHeader() {
    if (!centerData) return;
    
    const titleElement = document.getElementById('centerTitle');
    const addressElement = document.getElementById('centerAddress');
    
    if (titleElement) {
        titleElement.textContent = `Danh sách Phòng khám - ${centerData.name || 'N/A'}`;
    }
    
    if (addressElement) {
        addressElement.textContent = centerData.address || 'N/A';
    }
}

// Chuyển tab
function switchTab(tab) {
    if (!centerId) return;
    
    if (tab === 'vaccines') {
        window.location.href = `/admin/centers/${centerId}/vaccines`;
    } else if (tab === 'working-hours') {
        window.location.href = `/admin/centers/${centerId}/working-hours`;
    }
    // Nếu tab là 'rooms', giữ nguyên trang hiện tại
}

// Load danh sách phòng khám
async function loadClinicRooms() {
    if (!centerId) return;
    
    try {
        const response = await fetch(`/api/clinic-rooms?centerId=${centerId}`);
        if (response.ok) {
            clinicRooms = await response.json();
            filteredRooms = [...clinicRooms];
            renderRooms();
            updateStats();
        } else {
            console.error('Failed to load clinic rooms');
        }
    } catch (error) {
        console.error('Error loading clinic rooms:', error);
    }
}

function renderRooms() {
    const tbody = document.getElementById('roomsTableBody');
    if (!tbody) return;
    
    if (filteredRooms.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="5" class="px-6 py-8 text-center text-[#61896f]">
                    Chưa có phòng khám nào tại trung tâm này
                </td>
            </tr>
        `;
        return;
    }
    
    tbody.innerHTML = filteredRooms.map(room => {
        const isActive = room.isActive !== false;
        const statusClass = isActive 
            ? 'bg-green-100 text-green-700 border border-green-200'
            : 'bg-zinc-100 text-zinc-600 border border-zinc-200';
        const statusText = isActive ? 'Hoạt động' : 'Tạm ngưng';
        
        // Xác định icon dựa trên description
        let icon = 'meeting_room';
        let iconColor = 'text-blue-500';
        if (room.description) {
            const desc = room.description.toLowerCase();
            if (desc.includes('tiêm') || desc.includes('vaccine')) {
                icon = 'vaccines';
                iconColor = 'text-primary';
            } else if (desc.includes('sàng lọc') || desc.includes('khám')) {
                icon = 'clinical_notes';
                iconColor = 'text-blue-500';
            } else if (desc.includes('theo dõi') || desc.includes('monitor')) {
                icon = 'visibility';
                iconColor = 'text-orange-500';
            }
        }
        
        return `
            <tr class="hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors">
                <td class="px-6 py-4">
                    <span class="text-sm font-bold text-[#111813] dark:text-white bg-zinc-100 dark:bg-zinc-800 px-2.5 py-1 rounded">${room.roomNumber || 'N/A'}</span>
                </td>
                <td class="px-6 py-4">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined ${iconColor} text-lg">${icon}</span>
                        <span class="text-sm font-medium text-[#111813] dark:text-zinc-300">${room.description || 'Phòng khám'}</span>
                    </div>
                </td>
                <td class="px-6 py-4">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold ${statusClass}">${statusText}</span>
                </td>
                <td class="px-6 py-4 text-sm text-[#61896f] dark:text-zinc-400">-</td>
                <td class="px-6 py-4 text-right">
                    <div class="flex justify-end gap-2">
                        <button onclick="editRoom(${room.id})" class="p-2 text-zinc-400 hover:text-primary hover:bg-primary/10 rounded-lg transition-all" title="Sửa">
                            <span class="material-symbols-outlined text-xl">edit</span>
                        </button>
                        <button onclick="deleteRoom(${room.id}, '${room.roomNumber}')" class="p-2 text-zinc-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all" title="Xóa">
                            <span class="material-symbols-outlined text-xl">delete</span>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    }).join('');
}

function updateStats() {
    const totalRooms = clinicRooms.length;
    const activeRooms = clinicRooms.filter(r => r.isActive !== false).length;
    const inactiveRooms = totalRooms - activeRooms;
    
    // Cập nhật các card thống kê
    const statsCards = document.querySelectorAll('.grid.grid-cols-1 p.text-2xl');
    if (statsCards.length >= 3) {
        statsCards[0].textContent = totalRooms;
        statsCards[1].textContent = activeRooms;
        statsCards[2].textContent = inactiveRooms;
    }
}

// Tìm kiếm và lọc
function filterRooms() {
    const searchTerm = document.getElementById('roomSearch').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter').value;
    
    filteredRooms = clinicRooms.filter(room => {
        const matchesSearch = !searchTerm || 
            (room.roomNumber && room.roomNumber.toLowerCase().includes(searchTerm)) ||
            (room.description && room.description.toLowerCase().includes(searchTerm));
        
        const matchesStatus = !statusFilter || 
            (statusFilter === 'true' && room.isActive !== false) ||
            (statusFilter === 'false' && room.isActive === false);
        
        return matchesSearch && matchesStatus;
    });
    
    renderRooms();
}

// Mở modal thêm phòng
function openAddRoomModal() {
    if (!centerId) {
        alert('Không tìm thấy ID trung tâm');
        return;
    }
    
    const modalHTML = `
        <div id="addRoomModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-[#102216]/60 backdrop-blur-sm">
            <div class="bg-white dark:bg-[#102216] w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden border border-white/10">
                <div class="px-6 py-4 border-b border-[#f0f4f2] dark:border-white/10 flex items-center justify-between">
                    <h3 class="text-xl font-bold text-[#111813] dark:text-white">Thêm Phòng khám mới</h3>
                    <button onclick="closeAddRoomModal()" class="p-2 hover:bg-[#f0f4f2] dark:hover:bg-white/10 rounded-full text-[#61896f] transition-colors">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="p-6">
                    <form id="addRoomForm" onsubmit="handleAddRoom(event)">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-[#111813] dark:text-white mb-2">Số phòng *</label>
                                <input type="text" id="roomNumber" name="roomNumber" required 
                                       class="w-full px-4 py-2 bg-[#f6f8f6] dark:bg-white/5 border-none rounded-xl text-sm focus:ring-2 focus:ring-primary/50 transition-all"
                                       placeholder="Ví dụ: P101, P102">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-[#111813] dark:text-white mb-2">Mô tả</label>
                                <textarea id="roomDescription" name="description" rows="3"
                                       class="w-full px-4 py-2 bg-[#f6f8f6] dark:bg-white/5 border-none rounded-xl text-sm focus:ring-2 focus:ring-primary/50 transition-all"
                                       placeholder="Ví dụ: Phòng tiêm chủng số 1"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-[#111813] dark:text-white mb-2">Trạng thái</label>
                                <select id="roomIsActive" name="isActive" 
                                        class="w-full px-4 py-2 bg-[#f6f8f6] dark:bg-white/5 border-none rounded-xl text-sm focus:ring-2 focus:ring-primary/50 transition-all">
                                    <option value="true" selected>Hoạt động</option>
                                    <option value="false">Tạm ngưng</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex justify-end gap-3 mt-6">
                            <button type="button" onclick="closeAddRoomModal()" class="px-6 py-2 text-sm font-bold text-[#61896f] hover:text-[#111813] dark:hover:text-white transition-colors">
                                Hủy
                            </button>
                            <button type="submit" class="px-8 py-2.5 bg-[#111813] dark:bg-white text-white dark:text-[#111813] text-sm font-bold rounded-xl hover:opacity-90 transition-all">
                                Thêm phòng
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHTML);
}

function closeAddRoomModal() {
    const modal = document.getElementById('addRoomModal');
    if (modal) {
        modal.remove();
    }
}

async function handleAddRoom(event) {
    event.preventDefault();
    
    if (!centerId) {
        alert('Không tìm thấy ID trung tâm');
        return;
    }
    
    const formData = new FormData(event.target);
    const roomNumber = formData.get('roomNumber');
    const description = formData.get('description') || null;
    const isActive = formData.get('isActive') === 'true';
    
    if (!roomNumber || roomNumber.trim() === '') {
        alert('Vui lòng nhập số phòng');
        return;
    }
    
    try {
        const response = await fetch('/api/clinic-rooms', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                centerId: parseInt(centerId),
                roomNumber: roomNumber.trim(),
                description: description,
                isActive: isActive
            })
        });
        
        if (response.ok) {
            alert('Thêm phòng khám thành công!');
            closeAddRoomModal();
            loadClinicRooms();
        } else {
            const error = await response.json();
            alert('Lỗi: ' + (error.error || 'Không thể thêm phòng khám'));
        }
    } catch (error) {
        console.error('Error adding room:', error);
        alert('Có lỗi xảy ra khi thêm phòng khám');
    }
}

async function editRoom(id) {
    const room = clinicRooms.find(r => r.id === id);
    if (!room) return;
    
    const roomNumber = prompt('Nhập số phòng:', room.roomNumber);
    if (roomNumber === null) return;
    
    const description = prompt('Nhập mô tả:', room.description || '');
    if (description === null) return;
    
    const isActive = confirm('Phòng đang hoạt động?') ? true : false;
    
    try {
        const response = await fetch(`/api/clinic-rooms/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                roomNumber: roomNumber,
                description: description,
                isActive: isActive
            })
        });
        
        if (response.ok) {
            alert('Cập nhật phòng khám thành công!');
            loadClinicRooms();
        } else {
            const error = await response.json();
            alert('Lỗi: ' + (error.error || 'Không thể cập nhật phòng khám'));
        }
    } catch (error) {
        console.error('Error updating room:', error);
        alert('Có lỗi xảy ra khi cập nhật phòng khám');
    }
}

async function deleteRoom(id, roomNumber) {
    if (!confirm(`Bạn có chắc chắn muốn xóa phòng "${roomNumber}"? Hành động này không thể hoàn tác.`)) {
        return;
    }
    
    try {
        const response = await fetch(`/api/clinic-rooms/${id}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        
        if (response.ok) {
            alert('Xóa phòng khám thành công!');
            loadClinicRooms();
        } else {
            const error = await response.json();
            alert('Lỗi: ' + (error.error || 'Không thể xóa phòng khám'));
        }
    } catch (error) {
        console.error('Error deleting room:', error);
        alert('Có lỗi xảy ra khi xóa phòng khám');
    }
}

// Khởi tạo khi trang load
document.addEventListener('DOMContentLoaded', () => {
    if (centerId) {
        loadCenterData();
        
        // Thêm event listeners cho tìm kiếm và lọc
        const searchInput = document.getElementById('roomSearch');
        const statusFilter = document.getElementById('statusFilter');
        
        if (searchInput) {
            searchInput.addEventListener('input', filterRooms);
        }
        
        if (statusFilter) {
            statusFilter.addEventListener('change', filterRooms);
        }
    } else {
        console.error('Center ID not found in URL');
    }
});
</script>

</body></html>